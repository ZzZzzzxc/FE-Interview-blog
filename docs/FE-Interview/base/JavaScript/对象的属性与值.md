# 对象的属性与值

## 对象的属性
在 ECMA-262 中，对象被定义为一个无序属性的集合，其属性可以包含基本值、对象或者函数。通常我们可以通过字面量或者构造函数的方式创建一个对象：

```js
//字面量
const o1 = {};
o1.name = "o1";
console.log(o1); //{ name: 'o1' }
//构造函数
const o2 = new Object();
o2.name = "o2";
console.log(o2); //{ name: 'o2' }
```
**JavaScript在创建对象的属性时，会带有一些用于描述其行为的特征值，这些属性因为其特征值的不同分为两类：数据属性和访问器属性。**

### 数据属性
数据属性又包括4个特征值：
- `[[Configurable]] `：表示能否通过 `delete` 删除属性，能否修改属性特性，能否把属性修改为访问器属性，默认为 `true` 。
- `[[Enumerable]]`：表示能否通过 `for-in` 循环返回属性，默认为 `true` 。
- `[[Writable]]`： 表示能否修改属性的值，默认为 `true `。
- `[[value]]`：属性的数据值，读取属性值的时候从这个位置读，写入属性值的时候，从这个位置写，默认为 `undefined` 。
### 访问器属性
访问器属性也包括4个特征值：
- `[[Configurable]] `：表示能否通过 `delete` 删除属性，能否修改属性特性，能否把属性修改为数据器属性，默认为 `true` 。
- `[[Enumerable]]`：表示能否通过 `for-in` 循环返回属性，默认为`true`。
- `[[Get]]`：在读取属性时调用的函数，默认为 `undefined` 。
- `[[Set]]`：在写入属性时调用的函数，默认为 `undefined` 。

**注意：将 `configurable` 设置为 `false` 是一个单向操作，不可撤销！**

### 操作属性的特征值
我们可以通过 `Object.defineProperty()` ， `Object.defineProperties()` 定义属性，或者通过 `Object.getOwnPropertyDescriptor()` 方法读取属性的特征值。

```js
const obj = {
  one: 100,
};

Object.defineProperty(obj, "double", {
  get() {
    return this.one;
  },
  set(val) {
    this.one = val * 2;
  },
});
console.log(obj.double); // 100
obj.double = 1000;
console.log(obj.double); // 1000
console.log(Object.getOwnPropertyDescriptor(obj, "double"));
//  {
//     get: [Function: get],
//     set: [Function: set],
//     enumerable: false,
//     configurable: false
//   }
```

在使用字面量定义对象的时候，也可以创建 `[[Getter]]`和 `[[Setter]]`：

```js
const obj = {
  value: 100,
  get val() {
    return this.value;
  },
  set val(newVal) {
    return (this.value = newVal * 2);
  },
};

console.log(obj.val); // 100
obj.val = 1000;
console.log(obj.val); // 2000
```



### 限制对象的行为

- 防止对象的扩展： `Object.preventExtensions()` ，可以阻止一个对象被添加新的属性。
- 封印：`Object.seal()` ，让一个对象不仅不能够添加新的属性，而且不能修改属性的特征值和使用 `delete` 操作，相当于调用了  `Object.preventExtensions()` 并将 `[[Configurable]] ` 设为了 `false`。
- 冻结：`Object.freeze()` ，相当于调用了  `Object.seal()` 并将 `[[Writable]] ` 设为了 `false`。

## 对象的值 

在访问对象的值的时候，引擎实际上会调用内部默认的  `[[Get]]`  操作，在设置值时调用  `[[Put]]`  操作。

###  [ [ Get ] ]

1. 直接在对象上查找属性，如果没有找到就会去遍历  `[[Prototype]]`  链，如果没有找到属性则返回 `undefined`。
2. 判断该属性是否为访问器属性，如果是且 `[[Getter]]` 存在，就调用 `[[Getter]]`。
3. 正常读取值。

### [ [ Put ] ]

1. 判断该属性是否为访问器属性，如果是且 `[[Setter]]` 存在，就调用 `[[Setter]]`。
2. 判断该属性是否为`writable` 为 `false` 的数据属性，如果是，在非 `strict mode` 下无声地失败，或者在 `strict mode` 下抛出 `TypeError`。
3. 正常设置值。
